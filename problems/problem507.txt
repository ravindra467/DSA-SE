b'Problem\nYou are given an undirected tree of NNN nodes. A positive weight WiW_iWi\xe2\x80\x8b is assigned to the node iii for all 1\xe2\x89\xa4i\xe2\x89\xa4N1 \\le i \\le N1\xe2\x89\xa4i\xe2\x89\xa4N.\nFor all 1\xe2\x89\xa4j\xe2\x89\xa4N\xe2\x88\x9211 \\le j \\le N-11\xe2\x89\xa4j\xe2\x89\xa4N\xe2\x88\x921, the jjj-th edge connects the nodes uju_juj\xe2\x80\x8b and vjv_jvj\xe2\x80\x8b, and has a restriction value of RjR_jRj\xe2\x80\x8b.\nAn array A1,A2,\xe2\x8b\xaf\xe2\x80\x89,ANA_1, A_2, \\cdots, A_NA1\xe2\x80\x8b,A2\xe2\x80\x8b,\xe2\x8b\xaf,AN\xe2\x80\x8b consisting of NNN non-negative integers is called valid if:\n\nFor all 1\xe2\x89\xa4j\xe2\x89\xa4N\xe2\x88\x9211 \\le j \\leq N-11\xe2\x89\xa4j\xe2\x89\xa4N\xe2\x88\x921, the condition Auj+Avj\xe2\x89\xa4RjA_{u_j}+A_{v_j} \\le R_jAuj\xe2\x80\x8b\xe2\x80\x8b+Avj\xe2\x80\x8b\xe2\x80\x8b\xe2\x89\xa4Rj\xe2\x80\x8b holds.\n\nThe profit of a valid array AAA is defined as profit(A)=\xe2\x88\x91i=1NAi\xe2\x8b\x85Wiprofit(A)=\\sum_{i=1}^N A_i \\cdot W_iprofit(A)=\xe2\x88\x91i=1N\xe2\x80\x8bAi\xe2\x80\x8b\xe2\x8b\x85Wi\xe2\x80\x8b\nFind the maximum possible value of profit(A)profit(A)profit(A) for some valid array AAA.\nInput Format\n\nThe first line of input contains a single integer TTT - the number of test cases. The description of TTT test cases follow.\nThe first line of each test case contains a single integer NNN - the number of nodes in the tree.\nThe second line of each test case contains NNN integers W1,W2,\xe2\x8b\xaf\xe2\x80\x89,WNW_1, W_2, \\cdots, W_NW1\xe2\x80\x8b,W2\xe2\x80\x8b,\xe2\x8b\xaf,WN\xe2\x80\x8b denoting the weights assigned to every node.\nThe next N\xe2\x88\x921N-1N\xe2\x88\x921 lines contain three space-separated integers each, with the jjj-th line containing uju_juj\xe2\x80\x8b, vjv_jvj\xe2\x80\x8b, and RjR_jRj\xe2\x80\x8b.\n\nOutput Format\nFor each test case, output the maximum possible value of profit(A)profit(A)profit(A).\nConstraints\n\n\n1\xe2\x89\xa4T\xe2\x89\xa41051 \\le T \\le 10^51\xe2\x89\xa4T\xe2\x89\xa4105\n3\xe2\x89\xa4N\xe2\x89\xa41053 \\le N \\le 10^53\xe2\x89\xa4N\xe2\x89\xa4105\n1\xe2\x89\xa4Wi\xe2\x89\xa41091 \\le W_i \\le 10^91\xe2\x89\xa4Wi\xe2\x80\x8b\xe2\x89\xa4109\n1\xe2\x89\xa4uj,vj\xe2\x89\xa4N1 \\le u_j, v_j \\le N1\xe2\x89\xa4uj\xe2\x80\x8b,vj\xe2\x80\x8b\xe2\x89\xa4N and uj\xe2\x89\xa0vju_j \\neq v_juj\xe2\x80\x8b\xee\x80\xa0=vj\xe2\x80\x8b\n1\xe2\x89\xa4Rj\xe2\x89\xa41091 \\le R_j \\le 10^91\xe2\x89\xa4Rj\xe2\x80\x8b\xe2\x89\xa4109\nIt is guaranteed that N\xe2\x8b\x85maxi=1NWi\xe2\x8b\x85maxj=1N\xe2\x88\x921Rj\xe2\x89\xa41018.N \\cdot \\text{max}_{i=1}^N W_i \\cdot \\text{max}_{j=1}^{N-1} R_j \\le 10^{18}.N\xe2\x8b\x85maxi=1N\xe2\x80\x8bWi\xe2\x80\x8b\xe2\x8b\x85maxj=1N\xe2\x88\x921\xe2\x80\x8bRj\xe2\x80\x8b\xe2\x89\xa41018.\nIt is guaranteed that the input forms a valid tree for all test cases.\nThe sum of NNN over all test cases do not exceed 10510^5105\n\n\nSample 1:\nInputOutput3\n3\n6 9 4\n1 2 2\n2 3 1\n6\n1 2 2 6 100 100\n1 2 9\n2 3 17\n2 4 3\n3 5 1\n3 6 4\n3\n120734269 1000000000 1\n1 2 300000000\n2 3 300000000\n16\n527\n300000000000000000\n\nExplanation:\nTest case-1: All valid arrays AAA are:\n\nA=[0,0,0]A = [0, 0, 0]A=[0,0,0]; profit(A)=0\xe2\x8b\x856+0\xe2\x8b\x859+0\xe2\x8b\x854=0profit(A) = 0 \\cdot 6 + 0 \\cdot 9 + 0 \\cdot 4 = 0profit(A)=0\xe2\x8b\x856+0\xe2\x8b\x859+0\xe2\x8b\x854=0\nA=[0,0,1]A = [0, 0, 1]A=[0,0,1]; profit(A)=0\xe2\x8b\x856+0\xe2\x8b\x859+1\xe2\x8b\x854=4profit(A) = 0 \\cdot 6 + 0 \\cdot 9 + 1 \\cdot 4 = 4profit(A)=0\xe2\x8b\x856+0\xe2\x8b\x859+1\xe2\x8b\x854=4\nA=[0,1,0]A = [0, 1, 0]A=[0,1,0]; profit(A)=0\xe2\x8b\x856+1\xe2\x8b\x859+0\xe2\x8b\x854=9profit(A) = 0 \\cdot 6 + 1 \\cdot 9 + 0 \\cdot 4 = 9profit(A)=0\xe2\x8b\x856+1\xe2\x8b\x859+0\xe2\x8b\x854=9\nA=[1,0,1]A = [1, 0, 1]A=[1,0,1]; profit(A)=1\xe2\x8b\x856+0\xe2\x8b\x859+1\xe2\x8b\x854=10profit(A) = 1 \\cdot 6 + 0 \\cdot 9 + 1 \\cdot 4 = 10profit(A)=1\xe2\x8b\x856+0\xe2\x8b\x859+1\xe2\x8b\x854=10\nA=[1,1,0]A = [1, 1, 0]A=[1,1,0]; profit(A)=1\xe2\x8b\x856+1\xe2\x8b\x859+0\xe2\x8b\x854=15profit(A) = 1 \\cdot 6 + 1 \\cdot 9 + 0 \\cdot 4 = 15profit(A)=1\xe2\x8b\x856+1\xe2\x8b\x859+0\xe2\x8b\x854=15\nA=[2,0,1]A = [2, 0, 1]A=[2,0,1]; profit(A)=2\xe2\x8b\x856+0\xe2\x8b\x859+1\xe2\x8b\x854=16profit(A) = 2 \\cdot 6 + 0 \\cdot 9 + 1 \\cdot 4 = 16profit(A)=2\xe2\x8b\x856+0\xe2\x8b\x859+1\xe2\x8b\x854=16\n\nThe maximum profit among all valid arrays AAA is 161616, which is the answer.\nTest case-2: The optimal AAA is [9,0,0,3,1,4][9, 0, 0, 3, 1, 4][9,0,0,3,1,4].\nTest case-3: The optimal AAA is [0,300000000,0][0, 300000000, 0][0,300000000,0].'