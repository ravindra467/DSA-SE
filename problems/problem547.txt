b"Problem\nYou are given a grid with 222 rows and NNN columns containing distinct integers. The number in the iii-th row and jjj-th column is denoted by Ai,jA_{i, j}Ai,j\xe2\x80\x8b. In one operation, you can swap numbers in any two cells which share a side.\nFor a binary string SSS of length NNN, let's define f(S)f(S)f(S) as follows:\n\nf(S)f(S)f(S) is the smallest number of swaps required to achieve a state of board in which A1,i<A2,iA_{1, i} \\lt A_{2, i}A1,i\xe2\x80\x8b<A2,i\xe2\x80\x8b if Si=1S_i = 1Si\xe2\x80\x8b=1, and A1,i>A2,iA_{1, i} \\gt A_{2, i}A1,i\xe2\x80\x8b>A2,i\xe2\x80\x8b if Si=0S_i = 0Si\xe2\x80\x8b=0, for each iii from 111 to NNN.\n\nIt's easy to show that it's possible to achieve any state of the board by swapping adjacent elements, so f(S)f(S)f(S) is always defined.\nFind the sum of f(S)f(S)f(S) over all 2N2^N2N binary strings SSS of length NNN.\nInput Format\n\nThe first line of the input contains a single integer TTT, the number of test cases. The description of the test cases follows.\nThe first line of each test case contains a single integer NNN.\nThen two lines follow, the iii-th line contains NNN space-separated integers Ai,1,Ai,2,\xe2\x80\xa6,Ai,NA_{i, 1}, A_{i, 2},\\ldots, A_{i, N}Ai,1\xe2\x80\x8b,Ai,2\xe2\x80\x8b,\xe2\x80\xa6,Ai,N\xe2\x80\x8b.\n\nOutput Format\nFor each test case, output a single integer \xe2\x80\x94 the sum of f(S)f(S)f(S) over all binary strings SSS of length NNN.\nConstraints\n\n\n1\xe2\x89\xa4T\xe2\x89\xa4201 \\le T \\le 201\xe2\x89\xa4T\xe2\x89\xa420\n1\xe2\x89\xa4N\xe2\x89\xa4501 \\le N \\le 501\xe2\x89\xa4N\xe2\x89\xa450\n1\xe2\x89\xa4Ai,j\xe2\x89\xa42\xe2\x8b\x85N1 \\le A_{i, j} \\le 2 \\cdot N1\xe2\x89\xa4Ai,j\xe2\x80\x8b\xe2\x89\xa42\xe2\x8b\x85N\nAll Ai,jA_{i, j}Ai,j\xe2\x80\x8b are distinct.\nThe sum of NNN over all test cases doesn't exceed 100100100.\n\n\nSample 1:\nInputOutput3\n3\n1 2 3\n4 5 6\n4\n3 6 1 7\n4 2 8 5\n5\n1 4 5 8 9\n2 3 6 7 1012\n30\n57\nExplanation:\nTest case 111: The minimum numbers of operations are 000 for S=S = S= 000, 111 for S=S = S= 100, 010, 001, 222 for 110, 101, 011, 333 for 111, so the sum of answers is 0\xe2\x8b\x851+1\xe2\x8b\x853+2\xe2\x8b\x853+3\xe2\x8b\x851=120 \\cdot 1 + 1 \\cdot 3 + 2 \\cdot 3 + 3 \\cdot 1 = 120\xe2\x8b\x851+1\xe2\x8b\x853+2\xe2\x8b\x853+3\xe2\x8b\x851=12."