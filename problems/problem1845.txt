b'Problem\nYou are given NNN edge-weighted trees T1,T2,\xe2\x80\xa6,TNT_1, T_2,\\ldots, T_NT1\xe2\x80\x8b,T2\xe2\x80\x8b,\xe2\x80\xa6,TN\xe2\x80\x8b having M1,M2,\xe2\x80\xa6,MNM_1, M_2,\\ldots ,M_NM1\xe2\x80\x8b,M2\xe2\x80\x8b,\xe2\x80\xa6,MN\xe2\x80\x8b nodes respectively. You also have an array AAA of N\xe2\x88\x921N-1N\xe2\x88\x921 positive integers.\nYou need to connect these NNN trees using N\xe2\x88\x921N-1N\xe2\x88\x921 edges such that each of these edges have weights equal to AiA_iAi\xe2\x80\x8b for some i\xe2\x88\x88[1,N\xe2\x88\x921]i \\in [1,N-1]i\xe2\x88\x88[1,N\xe2\x88\x921] and each of the AiA_iAi\xe2\x80\x8b must be used exactly once. Note that after connecting these edges, a single large tree TTT will form consisting of (M1+M2+\xe2\x80\xa6+MN)(M_1+M_2+\\ldots+M_N)(M1\xe2\x80\x8b+M2\xe2\x80\x8b+\xe2\x80\xa6+MN\xe2\x80\x8b) nodes. Find the minimum possible sum of distances between each pair of nodes in the final tree TTT.\nSince this value can be large, output the value mod 998244353998244353998244353.\nInput Format\n\nThe first line of input will contain a single integer NNN, denoting the number of trees.\nThen, you are given the NNN trees. The description of each tree is as follows:\n\nThe first line contains the integer MiM_iMi\xe2\x80\x8b (1\xe2\x89\xa4i\xe2\x89\xa4N)(1 \\le i \\le N)(1\xe2\x89\xa4i\xe2\x89\xa4N), the number of nodes in iii-th tree.\nThe next Mi\xe2\x88\x921M_i-1Mi\xe2\x80\x8b\xe2\x88\x921 lines describe the edges of the iii-th tree. The jjj-th of these Mi\xe2\x88\x921M_i-1Mi\xe2\x80\x8b\xe2\x88\x921 lines contains 333 space-separated integers uij,viju_{ij}, v_{ij}uij\xe2\x80\x8b,vij\xe2\x80\x8b and wijw_{ij}wij\xe2\x80\x8b, describing that there is an edge of weight wijw_{ij}wij\xe2\x80\x8b connecting the nodes uiju_{ij}uij\xe2\x80\x8b and vijv_{ij}vij\xe2\x80\x8b in tree TiT_iTi\xe2\x80\x8b.\n\n\nThe final line contains N\xe2\x88\x921N-1N\xe2\x88\x921 space-separated integers, A1,A2,\xe2\x80\xa6,AN\xe2\x88\x921A_1, A_2,\\ldots,A_{N-1}A1\xe2\x80\x8b,A2\xe2\x80\x8b,\xe2\x80\xa6,AN\xe2\x88\x921\xe2\x80\x8b.\n\nOutput Format\nFor each test case, output on a new line the minimum sum of distances between each pair of nodes in tree TTT, modulo 998244353998244353998244353.\nConstraints\n\n\n2\xe2\x89\xa4N\xe2\x89\xa41042 \\leq N \\leq 10^42\xe2\x89\xa4N\xe2\x89\xa4104\n1\xe2\x89\xa4Mi\xe2\x89\xa45\xe2\x8b\x851041 \\leq M_i \\leq 5\\cdot 10^41\xe2\x89\xa4Mi\xe2\x80\x8b\xe2\x89\xa45\xe2\x8b\x85104\n1\xe2\x89\xa4uij,vij\xe2\x89\xa4Mi1 \\leq u_{ij}, v_{ij} \\leq M_i1\xe2\x89\xa4uij\xe2\x80\x8b,vij\xe2\x80\x8b\xe2\x89\xa4Mi\xe2\x80\x8b\n1\xe2\x89\xa4wij\xe2\x89\xa41081 \\leq w_{ij} \\leq 10^81\xe2\x89\xa4wij\xe2\x80\x8b\xe2\x89\xa4108\n1\xe2\x89\xa4Ai\xe2\x89\xa41081 \\leq A_i \\leq 10^81\xe2\x89\xa4Ai\xe2\x80\x8b\xe2\x89\xa4108\nThe sum (M1+M2+\xe2\x80\xa6+MN)(M_1+M_2+\\ldots +M_N)(M1\xe2\x80\x8b+M2\xe2\x80\x8b+\xe2\x80\xa6+MN\xe2\x80\x8b) does not exceed 10510^5105.\n\n\nSubtasks\n\n\nSubtask 1 (30 points): N=2N = 2N=2\nSubtask 2 (70 points): Original constraints.\n\n\nSample 1:\nInputOutput2\n3\n1 2 1\n2 3 3\n4\n1 2 2\n1 3 1\n1 4 3\n1\n72\nExplanation:\nAn optimal solution for the given test case looks as follows:\n'