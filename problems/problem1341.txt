b"Problem\nRead problems statements in Mandarin chinese, Russian and Vietnamese as well.\nPaavini, Nupur, Anchal and Ishita are four best friends and roommates. In their normal routine, they only study and study and do nothing else. But now that exams are over, they want to explore the town, so they went to the Trade Fair to eat.\nThe trade fair has N halls and it's represented by a tree with N vertices and N-1 edges. Each edge contains exactly one restaurant offering only meals of one type at a fixed cost.\nSince Bhavya and Kaushal didn't go along with them, they have asked Q queries. Each query is given as follows: The friends move from hall U to hall V along the shortest path. From each restaurant they encounter on this path, they will purchase exactly one meal in total if its cost C satisfies the following conditions:\n\nIf C is a multiple of 2, C must be between X1 and Y1 inclusive.\nIf C is a multiple of 3, C must be between X2 and Y2 inclusive.\nIf C is a multiple of 5, C must be between X3 and Y3 inclusive.\nC must be a multiple of 2, 3 or 5.\n\n\nFor each query, compute the total cost of all meals bought when travelling from U to V. you have the answer the queries in online mode.\nInput\n\nThe first line of the input contains two space-separated integers N and Q denoting the number of halls and the number of queries respectively.\nEach of the following N-1 lines contains three space-separated integers U, V and C denoting an edge connecting halls U and V and containing a restaurant which provides a meal with cost C.\nEach of the following Q lines contains eight space-separated integers in1, in2, in3, in4, in5, in6, in7 and in8 describing one query. Lets define last as the answer of the previous query modulo 100,000 (if it was the first query then last = 0), the parameters of the query can be calculated by:\n\nU = in1 + last V = in2 + last X1 = in3 + last Y1 = in4 + last X2 = in5 + last Y2 = in6 + last X3 = in7 + last Y3 = in8 + last\n\n\nOutput\nFor each query, print the answer to it on a separate line.\nConstraints\n\n1 \xe2\x89\xa4 N, Q \xe2\x89\xa4 50,000\n1 \xe2\x89\xa4 U, V \xe2\x89\xa4 N\n1 \xe2\x89\xa4 C \xe2\x89\xa4 40,000\n1 \xe2\x89\xa4 Xi \xe2\x89\xa4 Y\ni \xe2\x89\xa4 40,000, for each 1 \xe2\x89\xa4 i \xe2\x89\xa4 3\n\nSubtasks\nSubtask #1 (20 points): 1 \xe2\x89\xa4 N, Q \xe2\x89\xa4 1000\nSubtask #2 (80 points): original constraints\nSample 1:\nInputOutput3 2\n1 2 6\n1 3 11\n2 3 2 20 3 20 2 4\n-4 -3 -4 14 -3 -1 -4 -26\n0\nExplanation:\nFor the first query, they will eat at the restaurant connecting halls 1 and 2; the cost of the meal there is 6.\nFor the second query, 6 is a multiple of 3, but according to the second condition, the cost of this meal isn't between 3 and 5. Hence they will not eat at any restaurant."