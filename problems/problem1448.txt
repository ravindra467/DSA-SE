b"Problem\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nYou are given an undirected weighted graph with NNN vertices (numbered 111 through NNN) and MMM edges (numbered 111 through MMM). For each valid iii, the iii-th edge has weight SiS_iSi\xe2\x80\x8b and connects vertices uiu_iui\xe2\x80\x8b and viv_ivi\xe2\x80\x8b. The weights of all edges are pairwise distinct.\nLet's denote an edge that connects vertices uuu and vvv by (u,v)(u,v)(u,v). A vibrating path is a sequence of distinct vertices V1,V2,\xe2\x80\xa6,VKV_1, V_2, \\ldots, V_KV1\xe2\x80\x8b,V2\xe2\x80\x8b,\xe2\x80\xa6,VK\xe2\x80\x8b such that the following conditions are satisfied:\n\n1\xe2\x89\xa4K\xe2\x89\xa42561 \\le K \\le 2561\xe2\x89\xa4K\xe2\x89\xa4256\nFor each valid iii, the edge (Vi,Vi+1)(V_i, V_{i+1})(Vi\xe2\x80\x8b,Vi+1\xe2\x80\x8b) exists in the graph.\nFor each valid iii and j\xe2\x89\xa4i\xe2\x88\x922j \\le i-2j\xe2\x89\xa4i\xe2\x88\x922, the edge (Vi,Vj)(V_i, V_j)(Vi\xe2\x80\x8b,Vj\xe2\x80\x8b) does not exist in the graph.\nFor each valid iii: If i>1i \\gt 1i>1, let's consider the graph without the edge (Vi\xe2\x88\x921,Vi)(V_{i-1}, V_i)(Vi\xe2\x88\x921\xe2\x80\x8b,Vi\xe2\x80\x8b); otherwise, consider the original graph. In this graph, the weight of the edge (Vi,Vi+1)(V_i, V_{i+1})(Vi\xe2\x80\x8b,Vi+1\xe2\x80\x8b) is the minimum of weights of all edges adjacent to ViV_iVi\xe2\x80\x8b.\n\nA graph is KKK-vertex-colourable if is possible to paint its vertices using at most KKK distinct colours in such a way that no edge connects two vertices with the same colour.\nYour task is to make the graph KKK-vertex-colourable by hitting the vertices. When a vertex uuu is hit, all the edges on the vibrating path with maximum length that starts at uuu are removed (note that this path is unique). You may hit vertices any number of times and in any order. However, each time you hit a vertex, at least one edge must be removed. For each valid iii, the cost of hitting the iii-th vertex is CiC_iCi\xe2\x80\x8b.\nYou should make the graph KKK-vertex-colourable and find one valid way to paint its vertices using KKK colours (numbered 111 through KKK). If there are multiple solutions, you may find any one. Then, the sum of costs of all hits you perform should be as small as possible.\nInput\n\nThe first line of the input contains three space-separated integers NNN, MMM and KKK.\nThe second line contains NNN space-separated integers C1,C2,\xe2\x80\xa6,CNC_1, C_2, \\ldots, C_NC1\xe2\x80\x8b,C2\xe2\x80\x8b,\xe2\x80\xa6,CN\xe2\x80\x8b.\nMMM lines follow. For each valid iii, the iii-th of these lines contains three space-separated integers uiu_iui\xe2\x80\x8b, viv_ivi\xe2\x80\x8b and SiS_iSi\xe2\x80\x8b.\n\nOutput\nPrint three lines.\n\nThe first of these lines should contain a single integer QQQ \xe2\x80\x95 the number of hits you want to perform.\nThe second line should contain QQQ space-separated integers \xe2\x80\x95 the vertices you want to hit, in order.\nThe third line should contain NNN space-separated integers x1,x2,\xe2\x80\xa6,xNx_1, x_2, \\ldots, x_Nx1\xe2\x80\x8b,x2\xe2\x80\x8b,\xe2\x80\xa6,xN\xe2\x80\x8b denoting that for each valid iii, the iii-th vertex should have the colour xix_ixi\xe2\x80\x8b (1\xe2\x89\xa4xi\xe2\x89\xa4K1 \\le x_i \\le K1\xe2\x89\xa4xi\xe2\x80\x8b\xe2\x89\xa4K).\n\nExample Input\n8 10 1\n1 2 3 4 5 6 7 8\n1 2 1\n1 3 7\n2 3 2\n3 4 8\n3 5 3\n4 6 9\n5 6 4\n6 7 5\n6 8 10\n7 8 6\n\nExample Output\n3\n1 2 7\n1 1 1 1 1 1 1 1\n\nExplanation\nThe following picture describes the graph:\n\n\nIn the first hit, the edge (1,2)(1, 2)(1,2) is removed.\nIn the second hit, the edges on the path (2,3,5,6,7)(2, 3, 5, 6, 7)(2,3,5,6,7) are removed.\nIn the third hit, the edges on the path (7,8,6,4,3,1)(7, 8, 6, 4, 3, 1)(7,8,6,4,3,1) are removed.\n\nTest generation and constraints\n\nNNN is either 10310^3103 or 10410^4104\nM=105M = 10^5M=105\nKKK is either 111, 222, 333 or 444\n\nThere are eight test files, one for each combination of NNN, MMM and KKK. For each test file:\n\nThe costs C1,C2,\xe2\x80\xa6,CNC_1, C_2, \\ldots, C_NC1\xe2\x80\x8b,C2\xe2\x80\x8b,\xe2\x80\xa6,CN\xe2\x80\x8b are chosen uniformly randomly and independently between 111 and 512512512 inclusive.\nMMM distinct undirected edges are chosen uniformly randomly and independently from the N\xe2\x8b\x85(N\xe2\x88\x921)/2N \\cdot (N-1)/2N\xe2\x8b\x85(N\xe2\x88\x921)/2 possibilities.\nS1,S2,\xe2\x80\xa6,SMS_1, S_2, \\ldots, S_MS1\xe2\x80\x8b,S2\xe2\x80\x8b,\xe2\x80\xa6,SM\xe2\x80\x8b is a uniformly randomly chosen permutation of the integers 111 through MMM.\n\nScoring\nIf you perform a hit where no edge is removed, or if there is an edge connecting two vertices with the same colour after performing all hits, you will receive the Wrong Answer verdict. Otherwise, the score of a test file is the sum of costs of all hits you perform. The score of a submission is the sum of scores of all test files. Your goal is to minimise the score of your submission.\nThere are 8 test files. During the contest, the displayed score will account for exactly 4 test files, i.e. your score reflects your submission's performance on 50% of the test files. However, if your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files. After the end of the contest, your score will be changed to include the sum of your program's scores over the other 4 test files."