b"Problem\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nYou are given a rooted tree with NNN vertices (numbered 111 through NNN) and a prime number PPP. Vertex 111 is the root of the tree and for each vvv (2\xe2\x89\xa4v\xe2\x89\xa4N2 \\le v \\le N2\xe2\x89\xa4v\xe2\x89\xa4N), the parent of vertex vvv is pvp_vpv\xe2\x80\x8b (pv<vp_v \\lt vpv\xe2\x80\x8b<v).\nA vertex sss is an ancestor of another vertex fff if sss lies on the path between 111 and fff (in particular, fff is its own ancestor). For two vertices uuu and vvv, let's define LCA(u,v)\\mathrm{LCA}(u, v)LCA(u,v) as the vertex sss with the largest number which is an ancestor of both uuu and vvv. Similarly, for two vertices vvv and sss, let Lv,s\\mathbb{L}_{v,s}Lv,s\xe2\x80\x8b be the set of all vertices uuu such that s=LCA(u,v)s = \\mathrm{LCA}(u, v)s=LCA(u,v).\nLet's define a set AP\\mathbb{A}_PAP\xe2\x80\x8b containing all sequences (indexed from 111) with length NNN whose elements are integers between 000 and P\xe2\x88\x921P-1P\xe2\x88\x921 inclusive. For two sequences a,b\xe2\x88\x88APa, b \\in \\mathbb{A}_Pa,b\xe2\x88\x88AP\xe2\x80\x8b, let's define an operation LCA-convolution as a sequence c=a\xe2\x88\x97bc = a * bc=a\xe2\x88\x97b such that for each valid xxx, cx=(\xe2\x88\x91i=1N\xe2\x88\x91j\xe2\x88\x88Li,xaibj)\xe2\x80\x8amod\xe2\x80\x8aP\xe2\x80\x89.c_x = \\left(\\sum\\limits_{i=1}^N \\sum\\limits_{j \\in \\mathbb{L}_{i,x}} a_i b_j\\right) \\bmod P \\,.cx\xe2\x80\x8b=(i=1\xe2\x88\x91N\xe2\x80\x8bj\xe2\x88\x88Li,x\xe2\x80\x8b\xe2\x88\x91\xe2\x80\x8bai\xe2\x80\x8bbj\xe2\x80\x8b)modP.\nYou are also given some sequence c\xe2\x88\x88APc \\in \\mathbb{A}_Pc\xe2\x88\x88AP\xe2\x80\x8b. You have two tasks:\n\nFind the number of sequences a\xe2\x88\x88APa \\in \\mathbb{A}_Pa\xe2\x88\x88AP\xe2\x80\x8b such that c=a\xe2\x88\x97ac = a * ac=a\xe2\x88\x97a. Since this number can be large, compute it modulo 998,244,353998,244,353998,244,353.\nFind a sequence a\xe2\x88\x88APa \\in \\mathbb{A}_Pa\xe2\x88\x88AP\xe2\x80\x8b such that c=a\xe2\x88\x97ac = a * ac=a\xe2\x88\x97a (if it exists).\n\nInput\n\nThe first line of the input contains a single integer TTT denoting the number of test cases. The description of TTT test cases follows.\nThe first line of each test case contains two space-separated integers NNN and PPP.\nThe second line contains N\xe2\x88\x921N-1N\xe2\x88\x921 space-separated integers p2,p3,\xe2\x80\xa6,pNp_2, p_3, \\ldots, p_Np2\xe2\x80\x8b,p3\xe2\x80\x8b,\xe2\x80\xa6,pN\xe2\x80\x8b.\nThe third line contains NNN space-separated integers c1,c2,\xe2\x80\xa6,cNc_1, c_2, \\ldots, c_Nc1\xe2\x80\x8b,c2\xe2\x80\x8b,\xe2\x80\xa6,cN\xe2\x80\x8b.\n\nOutput\nFor each test case, print two lines:\n\nThe first of these lines should contain a single integer \xe2\x80\x95 the number of sequences from the first task modulo 998,244,353998,244,353998,244,353.\nIf there is no sequence a\xe2\x88\x88APa \\in \\mathbb{A}_Pa\xe2\x88\x88AP\xe2\x80\x8b such that c=a\xe2\x88\x97ac = a * ac=a\xe2\x88\x97a, the second line should contain the integer \xe2\x88\x921-1\xe2\x88\x921.\nOtherwise, the second line should contain NNN space-separated integers a1,a2,\xe2\x80\xa6,aNa_1, a_2, \\ldots, a_Na1\xe2\x80\x8b,a2\xe2\x80\x8b,\xe2\x80\xa6,aN\xe2\x80\x8b, where a\xe2\x88\x88APa \\in \\mathbb{A}_Pa\xe2\x88\x88AP\xe2\x80\x8b and c=a\xe2\x88\x97ac = a * ac=a\xe2\x88\x97a should hold. If there is more than one such sequence, you may find any one of them.\n\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa41051 \\le T \\le 10^51\xe2\x89\xa4T\xe2\x89\xa4105\n2\xe2\x89\xa4N\xe2\x89\xa45\xe2\x8b\x851052 \\le N \\le 5 \\cdot 10^52\xe2\x89\xa4N\xe2\x89\xa45\xe2\x8b\x85105\n3\xe2\x89\xa4P\xe2\x89\xa4109+93 \\le P \\le 10^9 + 93\xe2\x89\xa4P\xe2\x89\xa4109+9\nPPP is a prime\n1\xe2\x89\xa4pi<i1 \\le p_i \\lt i1\xe2\x89\xa4pi\xe2\x80\x8b<i for each valid iii\n0\xe2\x89\xa4ci<P0 \\le c_i \\lt P0\xe2\x89\xa4ci\xe2\x80\x8b<P for each valid iii\nthe sum of NNN over all test cases does not exceed 5\xe2\x8b\x851055 \\cdot 10^55\xe2\x8b\x85105\n\nSubtasks\nSubtask 1 (10 points, 1 second time limit):\n\nT\xe2\x89\xa4100T \\le 100T\xe2\x89\xa4100\nN\xe2\x89\xa46N \\le 6N\xe2\x89\xa46\nP=3P = 3P=3\n\nSubtask 2 (30 points, 1 second time limit):\n\nT\xe2\x89\xa4100T \\le 100T\xe2\x89\xa4100\nthe sum of NNN over all test cases does not exceed 1,0001,0001,000\n\nSubtask 3 (60 points, 5 seconds time limit): original constraints\nExample Input\n3\r\n6 3\r\n1 1 2 3 2\r\n1 2 0 1 1 1\r\n5 3\r\n1 1 1 3\r\n2 1 0 2 1\r\n9 101\r\n1 1 2 3 2 4 3 5\r\n18 77 44 82 4 20 19 43 97\n\nExample Output\n32\r\n2 2 0 1 2 2\r\n0\r\n-1\r\n64\r\n3 70 5 76 20 11 25 12 81\n"