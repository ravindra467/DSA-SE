b'Problem\nChef has a sequence of NNN integers A1,A2,\xe2\x80\xa6,ANA_1, A_2,\\dots, A_NA1\xe2\x80\x8b,A2\xe2\x80\x8b,\xe2\x80\xa6,AN\xe2\x80\x8b. He defines a function f(i,j)f(i, j)f(i,j) as follows:\nf(i,j)=Ai+max(Ai,Ai+1)+max(Ai,Ai+1,Ai+2)+\xe2\x8b\xaf+max(Ai,Ai+1,\xe2\x80\xa6,Aj)f(i, j) = A_i + max(A_i, A_{i + 1}) + max(A_i, A_{i + 1}, A_{i + 2}) + \\dots + max(A_i, A_{i + 1}, \\dots, A_j)f(i,j)=Ai\xe2\x80\x8b+max(Ai\xe2\x80\x8b,Ai+1\xe2\x80\x8b)+max(Ai\xe2\x80\x8b,Ai+1\xe2\x80\x8b,Ai+2\xe2\x80\x8b)+\xe2\x8b\xaf+max(Ai\xe2\x80\x8b,Ai+1\xe2\x80\x8b,\xe2\x80\xa6,Aj\xe2\x80\x8b)\nChef tries to find the sum of f(i,j)f(i, j)f(i,j) over all (i,j)(i, j)(i,j) such that 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4N1 \\leq i \\leq j \\leq N1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4N (i.e\xe2\x88\x91i=1n\xe2\x88\x91j=inf(i,j))(i.e \\sum\\limits_{i=1}^n \\sum\\limits_{j=i}^nf(i, j))(i.ei=1\xe2\x88\x91n\xe2\x80\x8bj=i\xe2\x88\x91n\xe2\x80\x8bf(i,j)), but fails. Can you help him find the sum?\nSince the sum can be very large, find it modulo (109+7)(10^9 + 7)(109+7).\nNote: Since the size of the input and output is large, please use fast input-output methods.\nInput Format\n\nThe first line of the input contains a single integer TTT denoting the number of test cases. The description of TTT test cases follows.\nThe first line of each test case contains an integer NNN.\nThe second line contains NNN space-separated integers A1,A2,\xe2\x80\xa6,ANA_1, A_2, \\dots, A_NA1\xe2\x80\x8b,A2\xe2\x80\x8b,\xe2\x80\xa6,AN\xe2\x80\x8b.\n\nOutput Format\nFor each test case, print a single line containing one integer - the required sum i.e \xe2\x88\x91i=1n\xe2\x88\x91j=inf(i,j)\\sum\\limits_{i=1}^n \\sum\\limits_{j=i}^nf(i, j)i=1\xe2\x88\x91n\xe2\x80\x8bj=i\xe2\x88\x91n\xe2\x80\x8bf(i,j) modulo (109+7)(10^9 + 7)(109+7).\nConstraints\n\n\n1\xe2\x89\xa4T\xe2\x89\xa45\xe2\x8b\x851031 \\leq T \\leq 5\\cdot 10^31\xe2\x89\xa4T\xe2\x89\xa45\xe2\x8b\x85103\n1\xe2\x89\xa4N\xe2\x89\xa42\xe2\x8b\x851051 \\leq N \\leq 2\\cdot 10^51\xe2\x89\xa4N\xe2\x89\xa42\xe2\x8b\x85105\n1\xe2\x89\xa4Ai\xe2\x89\xa41091 \\leq A_i \\leq 10^91\xe2\x89\xa4Ai\xe2\x80\x8b\xe2\x89\xa4109\nSum of NNN over all test cases does not exceed 10610^6106.\n\n\nSample 1:\nInputOutput3\n2\n1 2\n3\n1 2 3\n4\n5 4 1 3\n6\n20\n82\n\nExplanation:\nTest case 111:\n\nf(1,1)=A1=1f(1, 1) = A_1 = 1f(1,1)=A1\xe2\x80\x8b=1.\nf(1,2)=A1+max(A1,A2)=1+max(1,2)=1+2=3f(1, 2) = A_1 + max(A_1, A_2) = 1 + max(1, 2) = 1 + 2 = 3f(1,2)=A1\xe2\x80\x8b+max(A1\xe2\x80\x8b,A2\xe2\x80\x8b)=1+max(1,2)=1+2=3.\nf(2,2)=A2=2f(2, 2) = A_2 = 2f(2,2)=A2\xe2\x80\x8b=2.\n\nHence the required sum =1+3+2=6= 1 + 3 + 2 = 6=1+3+2=6.\nTest case 222:\n\nf(1,1)=A1=1f(1, 1) = A_1 = 1f(1,1)=A1\xe2\x80\x8b=1.\nf(1,2)=A1+max(A1,A2)=1+max(1,2)=1+2=3f(1, 2) = A_1 + max(A_1, A_2) = 1 + max(1, 2) = 1 + 2 = 3f(1,2)=A1\xe2\x80\x8b+max(A1\xe2\x80\x8b,A2\xe2\x80\x8b)=1+max(1,2)=1+2=3.\nf(1,3)=A1+max(A1,A2)+max(A1,A2,A3)=1+max(1,2)+max(1,2,3)=1+2+3=6f(1, 3) = A_1 + max(A_1, A_2) + max(A_1, A_2, A_3) = 1 + max(1, 2) + max(1, 2, 3) = 1 + 2 + 3 = 6f(1,3)=A1\xe2\x80\x8b+max(A1\xe2\x80\x8b,A2\xe2\x80\x8b)+max(A1\xe2\x80\x8b,A2\xe2\x80\x8b,A3\xe2\x80\x8b)=1+max(1,2)+max(1,2,3)=1+2+3=6.\nf(2,2)=A2=2f(2, 2) = A_2 = 2f(2,2)=A2\xe2\x80\x8b=2.\nf(2,3)=A2+max(A2,A3)=2+max(2,3)=2+3=5f(2, 3) = A_2 + max(A_2, A_3) = 2 + max(2, 3) = 2 + 3 = 5f(2,3)=A2\xe2\x80\x8b+max(A2\xe2\x80\x8b,A3\xe2\x80\x8b)=2+max(2,3)=2+3=5.\nf(3,3)=A3=3f(3, 3) = A_3 = 3f(3,3)=A3\xe2\x80\x8b=3.\n\nHence the required sum =1+3+6+2+5+3=20= 1 + 3 + 6 + 2 + 5 + 3 = 20=1+3+6+2+5+3=20.'