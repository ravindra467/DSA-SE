b'Problem\nRead problems statements in Mandarin Chinese, Russian, Vietnamese, and Bengali as well.\nYou are given a tree with NNN vertices (numbered 111 through NNN) rooted at vertex 111. There are MMM blue tokens (numbered 111 through MMM) and 111 red token. For each valid iii, the iii-th blue token appears at the root at an integer time tit_iti\xe2\x80\x8b seconds and moves to a leaf vertex viv_ivi\xe2\x80\x8b, crossing one edge per second. In the next second after reaching viv_ivi\xe2\x80\x8b, this token disappears.\nYou control the red token. First, given a starting time SSS, you must choose some leaf vertex of the tree and place it at this vertex at some integer time ttt seconds such that t\xe2\x89\xa5St \\geq St\xe2\x89\xa5S. In one second, you can move the red token to any vertex adjacent to its current vertex. Your aim is to move the red token to vertex 111.\nAt each integer moment in time, the red token is not allowed to be in the same vertex as any blue token.\nAdditionally, you have a hidden ability called KKK-teleport, which can be used any number of times. Whenever KKK-teleport is used to move the red token from its current vertex uuu to some vertex vvv of your choice (possibly uuu itself), it phases out of existence (so it cannot clash with any blue token) and appears in vvv at an integer moment in time of your choice which is at least K\xe2\x8b\x85dist(u,v)K \\cdot \\mathrm{dist}(u, v)K\xe2\x8b\x85dist(u,v) seconds later. Here, dist(u,v)\\mathrm{dist}(u, v)dist(u,v) denotes the shortest distance between vertices uuu and vvv.\nFind the minimum time at which the red token can reach the root without clashing with any blue token.\nInput\n\nThe first line of the input contains a single integer TTT denoting the number of test cases. The description of TTT test cases follows.\nThe first line of each test case contains four space-separated integers NNN, MMM, KKK and SSS.\nEach of the next N\xe2\x88\x921N - 1N\xe2\x88\x921 lines contains two space-separated integers uuu and vvv denoting that vertices uuu and vvv are connected by an edge.\nMMM more lines follow. For each valid iii, the iii-th of these lines contains two space-separated integers tit_iti\xe2\x80\x8b and viv_ivi\xe2\x80\x8b.\n\nOutput\nFor each test case, print a single line containing one integer \xe2\x80\x95 the minimum time at which you can reach the root.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa41051 \\leq T \\leq 10^51\xe2\x89\xa4T\xe2\x89\xa4105\n2\xe2\x89\xa4N\xe2\x89\xa42\xe2\x8b\x851052 \\leq N \\leq 2 \\cdot 10^52\xe2\x89\xa4N\xe2\x89\xa42\xe2\x8b\x85105\n1\xe2\x89\xa4M\xe2\x89\xa42\xe2\x8b\x851051 \\leq M \\leq 2 \\cdot 10^51\xe2\x89\xa4M\xe2\x89\xa42\xe2\x8b\x85105\n1\xe2\x89\xa4K\xe2\x89\xa41091 \\leq K \\leq 10^91\xe2\x89\xa4K\xe2\x89\xa4109\n0\xe2\x89\xa4S\xe2\x89\xa41090 \\leq S \\leq 10^90\xe2\x89\xa4S\xe2\x89\xa4109\n1\xe2\x89\xa4u,v\xe2\x89\xa4N1 \\le u, v \\le N1\xe2\x89\xa4u,v\xe2\x89\xa4N\nthe graph described on the input is a tree\n0\xe2\x89\xa4ti\xe2\x89\xa41090 \\leq t_i \\leq 10^90\xe2\x89\xa4ti\xe2\x80\x8b\xe2\x89\xa4109 for each valid iii\n1\xe2\x89\xa4vi\xe2\x89\xa4N1 \\leq v_i \\leq N1\xe2\x89\xa4vi\xe2\x80\x8b\xe2\x89\xa4N for each valid iii\nviv_ivi\xe2\x80\x8b is a leaf vertex for each valid iii\nthe sum of NNN over all test cases does not exceed 2\xe2\x8b\x851052 \\cdot 10^52\xe2\x8b\x85105\nthe sum of MMM over all test cases does not exceed 2\xe2\x8b\x851052 \\cdot 10^52\xe2\x8b\x85105\n\nSample 1:\nInputOutput3\n4 5 3 2\n1 2\n2 3\n2 4\n3 4\n3 3\n4 4\n5 4\n6 4\n2 1 3 0\n1 2\n1 2\n4 5 6 3\n2 1\n3 2\n4 2\n1 4\n1 3\n4 4\n5 4\n7 37\n2\n8\nExplanation:\nExample case 1: One of the possible solutions is shown below.\n\nAt t=3t = 3t=3, you may use 333-teleport from 222 to 111, arriving at vertex 111 at the time t=7t = 7t=7, since 3\xe2\x8b\x85dist(2,1)=33 \\cdot \\mathrm{dist}(2, 1) = 33\xe2\x8b\x85dist(2,1)=3 and 3+3\xe2\x89\xa473+3 \\leq 73+3\xe2\x89\xa47.\nExample case 2: One of the possible solutions is shown below.\n\nExample case 3: One of the possible solutions is shown below.\n\nAt t=4t = 4t=4, you may use 666-teleport from 333 to 333, arriving at vertex 333 at the time t=6t = 6t=6, since 6\xe2\x8b\x85dist(3,3)=06 \\cdot \\mathrm{dist}(3, 3) = 06\xe2\x8b\x85dist(3,3)=0 and 4+0\xe2\x89\xa464+0 \\leq 64+0\xe2\x89\xa46.'