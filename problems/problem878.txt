b'Problem\nRead problems statements in Mandarin chinese, Russian and Vietnamese as well.\nYou are given a binary tree with NNN vertices numbered 111 through NNN. The root of the tree is vertex 111. There are two types of vertices:\n\nnon-leaf: has exactly two sons \xe2\x80\x94 a left son and a right son\nleaf: doesn\'t have sons, but it has an integer value\n\nLet\'s denote the number of leaves by LLL. It is guaranteed that the values of all leaves are pairwise distinct numbers between 111 and LLL inclusive.\nTo each leaf, we can assign a string in the following way:\n\nconsider the simple path 1=v1,v2,\xe2\x80\xa6,vl1=v_1, v_2, \\dots, v_l1=v1\xe2\x80\x8b,v2\xe2\x80\x8b,\xe2\x80\xa6,vl\xe2\x80\x8b from the root to leaf vlv_lvl\xe2\x80\x8b\nthe string SvlS_{v_l}Svl\xe2\x80\x8b\xe2\x80\x8b assigned to leaf vlv_lvl\xe2\x80\x8b has length l\xe2\x88\x921l-1l\xe2\x88\x921; for each valid iii, SiS_iSi\xe2\x80\x8b is \'L\' if vi+1v_{i+1}vi+1\xe2\x80\x8b is the left son of viv_ivi\xe2\x80\x8b or \'R\' if it\'s the right son of viv_ivi\xe2\x80\x8b\n\nIt\'s clear that these strings are all pairwise distinct. Let\'s call the tree leaf-sorted if the following property holds for every pair of different leaves a,ba, ba,b: SaS_aSa\xe2\x80\x8b is lexicographically smaller than SbS_bSb\xe2\x80\x8b if and only if the value of aaa is smaller than the value of bbb.\nYou are allowed to perform the following operation an arbitrary number of times (including zero): choose a non-leaf vertex and swap the edges to its left and right son. That is, the original left son of this vertex becomes the right son and the original right son becomes the left son (along with their whole subtrees).\nFind the minimum number of operations needed to make the tree leaf-sorted, or determine that it\'s impossible.\nInput\n\nThe first line of the input contains a single integer TTT denoting the number of test cases. The description of TTT test cases follows.\nThe first line of each test case contains a single integer NNN.\nNNN lines follow. For each iii (1\xe2\x89\xa4i\xe2\x89\xa4N1 \\le i \\le N1\xe2\x89\xa4i\xe2\x89\xa4N), the iii-th of these lines contains two space-separated integers lll and rrr. If l=\xe2\x88\x921l = -1l=\xe2\x88\x921, vertex iii is a leaf with value rrr. Otherwise, lll and rrr respectively denote the left and right son of vertex iii.\n\nOutput\nFor each test case, print a single line containing one integer \xe2\x80\x94 the minimum required number of operations or \xe2\x88\x921-1\xe2\x88\x921 if it\'s impossible to make the tree leaf-sorted.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa41,0001 \\le T \\le 1,0001\xe2\x89\xa4T\xe2\x89\xa41,000\n2\xe2\x89\xa4N\xe2\x89\xa41052 \\le N \\le 10^52\xe2\x89\xa4N\xe2\x89\xa4105\n1\xe2\x89\xa4r\xe2\x89\xa4L1 \\le r \\le L1\xe2\x89\xa4r\xe2\x89\xa4L for each leaf (l=\xe2\x88\x921l = -1l=\xe2\x88\x921)\n1\xe2\x89\xa4l,r\xe2\x89\xa4N1 \\le l, r \\le N1\xe2\x89\xa4l,r\xe2\x89\xa4N for each non-leaf\nthe values of all leaves are pairwise distinct\nthe graph described on the input is a binary tree rooted at vertex 111\nthe sum of NNN for all test cases does not exceed 2\xe2\x8b\x851052 \\cdot 10^52\xe2\x8b\x85105\n\nSubtasks\nSubtask #1 (30 points):\n\n1\xe2\x89\xa4T\xe2\x89\xa41001 \\le T \\le 1001\xe2\x89\xa4T\xe2\x89\xa4100\n2\xe2\x89\xa4N\xe2\x89\xa4302 \\le N \\le 302\xe2\x89\xa4N\xe2\x89\xa430\n\nSubtask #2 (20 points):\n\n1\xe2\x89\xa4T\xe2\x89\xa41001 \\le T \\le 1001\xe2\x89\xa4T\xe2\x89\xa4100\n2\xe2\x89\xa4N\xe2\x89\xa41,0002 \\le N \\le 1,0002\xe2\x89\xa4N\xe2\x89\xa41,000\nthe sum of NNN for all test cases does not exceed 2,0002,0002,000\n\nSubtask #3 (50 points): original constraints\nSample 1:\nInputOutput2\n5\n3 5\n-1 2\n2 4\n-1 3\n-1 1\n7\n2 3\n4 5\n6 7\n-1 1\n-1 4\n-1 3\n-1 21\n-1\nExplanation:\nExample case 1: The leaves of this tree are vertices 2,4,52, 4, 52,4,5, the strings assigned to them are "LL", "LR", "R" and their values are 2,3,12, 3, 12,3,1. The strings are in increasing order and the corresponding values are not, so the tree isn\'t leaf-sorted. However, if we swap the left and right son of the root (vertex 111), the strings assigned to the vertices become "RL, "RR", "L", so the tree becomes leaf-sorted.'