b'Problem\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nChef is preparing tests for the problem "Move the Coins"!\nHe needs to create a tree GGG with NNN nodes (numbered 111 through NNN), which is rooted at node 111, and a list of QQQ distinct reparentings. A reparenting is a pair of nodes (u,v)(u, v)(u,v) (u\xe2\x89\xa01u \\neq 1u\xee\x80\xa0=1) of GGG and the result of applying it to GGG is another graph, formed as follows:\n\nTake a copy of the original tree GGG.\nIn this copy, remove the edge connecting the vertex uuu to its parent.\nThen, add a new edge between the nodes uuu and vvv.\n\nAs an example, consider the following tree GGG:\n\nWe wish to apply the reparenting r=(6,3)r = (6, 3)r=(6,3) to it. The resulting graph would be\n\nA reparenting rrr is valid if the resulting graph is still a tree (that is, a connected graph without cycles). For the time being, Chef wants to generate only valid reparentings.\nChef has already decided on the tree GGG and now he just needs to pick QQQ valid reparentings. He makes an initial list LLL of all valid reparentings for this tree and sorts them in a special order.\nLet r=(u,v)r = (u, v)r=(u,v) and r\xe2\x80\xb2=(u\xe2\x80\xb2,v\xe2\x80\xb2)r\' = (u\', v\')r\xe2\x80\xb2=(u\xe2\x80\xb2,v\xe2\x80\xb2) be valid reparentings. Their order is decided as follows:\n\nif u<u\xe2\x80\xb2u \\lt u\'u<u\xe2\x80\xb2, then r<r\xe2\x80\xb2r \\lt r\'r<r\xe2\x80\xb2\nif u>u\xe2\x80\xb2u \\gt u\'u>u\xe2\x80\xb2, then r>r\xe2\x80\xb2r \\gt r\'r>r\xe2\x80\xb2\nif u=u\xe2\x80\xb2u = u\'u=u\xe2\x80\xb2, find the distances of nodes vvv and v\xe2\x80\xb2v\'v\xe2\x80\xb2 from the root and denote them by hhh and h\xe2\x80\xb2h\'h\xe2\x80\xb2 respectively\nif u=u\xe2\x80\xb2u = u\'u=u\xe2\x80\xb2 and h<h\xe2\x80\xb2h \\lt h\'h<h\xe2\x80\xb2, then r<r\xe2\x80\xb2r \\lt r\'r<r\xe2\x80\xb2\nif u=u\xe2\x80\xb2u = u\'u=u\xe2\x80\xb2 and h>h\xe2\x80\xb2h \\gt h\'h>h\xe2\x80\xb2, then r>r\xe2\x80\xb2r \\gt r\'r>r\xe2\x80\xb2\nif u=u\xe2\x80\xb2u = u\'u=u\xe2\x80\xb2, h=h\xe2\x80\xb2h = h\'h=h\xe2\x80\xb2 and v<v\xe2\x80\xb2v \\lt v\'v<v\xe2\x80\xb2, then r<r\xe2\x80\xb2r \\lt r\'r<r\xe2\x80\xb2\nif u=u\xe2\x80\xb2u = u\'u=u\xe2\x80\xb2, h=h\xe2\x80\xb2h = h\'h=h\xe2\x80\xb2 and v>v\xe2\x80\xb2v \\gt v\'v>v\xe2\x80\xb2, then r>r\xe2\x80\xb2r \\gt r\'r>r\xe2\x80\xb2\n\nChef chooses QQQ integers c1,c2,\xe2\x80\xa6,cQc_1, c_2, \\ldots, c_Qc1\xe2\x80\x8b,c2\xe2\x80\x8b,\xe2\x80\xa6,cQ\xe2\x80\x8b, removes the c1c_1c1\xe2\x80\x8b-th element of LLL, then removes the c2c_2c2\xe2\x80\x8b-th element of the resulting (smaller) list LLL, and so on, until he removes the cQc_QcQ\xe2\x80\x8b-th element. The sequence c1,c2,\xe2\x80\xa6,cQc_1, c_2, \\ldots, c_Qc1\xe2\x80\x8b,c2\xe2\x80\x8b,\xe2\x80\xa6,cQ\xe2\x80\x8b is chosen in such a way that during this process, each of them is a valid index of an element in the current list LLL. This way, he removes QQQ distinct valid reparentings and uses them in one test.\nBecause Chef does not believe in making life easy for himself, the sequence c1,c2,\xe2\x80\xa6,cQc_1, c_2, \\ldots, c_Qc1\xe2\x80\x8b,c2\xe2\x80\x8b,\xe2\x80\xa6,cQ\xe2\x80\x8b is encrypted and each of its elements cannot be decrypted until all previous reparentings are found. More formally, consider a decryption key ddd; initially, d=0d = 0d=0. You are given an encrypted sequence e1,e2,\xe2\x80\xa6,eQe_1, e_2, \\ldots, e_Qe1\xe2\x80\x8b,e2\xe2\x80\x8b,\xe2\x80\xa6,eQ\xe2\x80\x8b. For each integer iii from 111 to QQQ, Chef decrypts ci=ei\xe2\x8a\x95dc_i = e_i \\oplus dci\xe2\x80\x8b=ei\xe2\x80\x8b\xe2\x8a\x95d (\xe2\x8a\x95\\oplus\xe2\x8a\x95 denotes the bitwise XOR operator), finds the cic_ici\xe2\x80\x8b-th reparenting in the current list LLL, denoted by (ui,vi)(u_i, v_i)(ui\xe2\x80\x8b,vi\xe2\x80\x8b), removes it from LLL and updates the decryption key ddd to (d+2i\xe2\x8b\x85ui+3i\xe2\x8b\x85vi)\xe2\x80\x89%\xe2\x80\x89(109+7)(d + 2^i \\cdot u_i + 3^i \\cdot v_i) \\,\\%\\, (10^9+7)(d+2i\xe2\x8b\x85ui\xe2\x80\x8b+3i\xe2\x8b\x85vi\xe2\x80\x8b)%(109+7).\nCan you help Chef find the QQQ valid reparentings corresponding to his encrypted choices? Calculating the final value of ddd will suffice to show that you can do it!\nInput\n\nThe first line of the input contains a single integer TTT denoting the number of test cases. The description of TTT test cases follows.\nThe first line of each test case contains a single integer NNN.\nEach of the next N\xe2\x88\x921N-1N\xe2\x88\x921 lines contains two space-separated integers aaa and bbb denoting that nodes aaa and bbb are connected by an edge.\nThe next line contains a single integer QQQ.\nQQQ lines follow. For each valid iii, the iii-th of these lines contains a single integer eie_iei\xe2\x80\x8b.\n\nOutput\nFor each test case, print a single line containing one integer \xe2\x80\x95 the final value of ddd after processing all QQQ reparentings.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa41,0001 \\le T \\le 1,0001\xe2\x89\xa4T\xe2\x89\xa41,000\n1\xe2\x89\xa4N,Q\xe2\x89\xa4200,0001 \\le N, Q \\le 200,0001\xe2\x89\xa4N,Q\xe2\x89\xa4200,000\n1\xe2\x89\xa4a,b\xe2\x89\xa4N1 \\le a, b \\le N1\xe2\x89\xa4a,b\xe2\x89\xa4N\n0\xe2\x89\xa4ei\xe2\x89\xa42360 \\le e_i \\le 2^{36}0\xe2\x89\xa4ei\xe2\x80\x8b\xe2\x89\xa4236 for each valid iii\n1\xe2\x89\xa4ci\xe2\x89\xa4R+1\xe2\x88\x92i1 \\le c_i \\le R+1-i1\xe2\x89\xa4ci\xe2\x80\x8b\xe2\x89\xa4R+1\xe2\x88\x92i for each valid iii, where RRR is the number of valid reparentings\nthe sum of NNN over all test cases does not exceed 200,000200,000200,000\nthe sum of QQQ over all test cases does not exceed 200,000200,000200,000\n\nSubtasks\nSubtask #1 (5 points):\n\nT\xe2\x89\xa410T \\le 10T\xe2\x89\xa410\nN,Q\xe2\x89\xa4100N, Q \\le 100N,Q\xe2\x89\xa4100\n\nSubtask #2 (10 points):\n\nT\xe2\x89\xa4100T \\le 100T\xe2\x89\xa4100\nN,Q\xe2\x89\xa41,000N, Q \\le 1,000N,Q\xe2\x89\xa41,000\n\nSubtask #3 (85 points): original constraints\nSample 1:\nInputOutput2\n5\n1 3\n1 2\n2 4\n2 5\n3\n5\n23\n72\n7\n1 7\n2 1\n6 1\n5 4\n3 5\n1 5\n5\n9\n6\n35\n313\n602126\n910\nExplanation:\nExample case 1: The tree GGG is\n\nThere are 252525 reparentings (u,v)(u,v)(u,v) ? too many to draw all of them! However, here is a representative sampling. Valid reparentings are marked with a \'?\'; invalid ones with a \'?\':\n\nWe can also form a table of validity of all reparentings (u,v)(u,v)(u,v):\n         v\r\n     1 2 3 4 5 \r\n     ?????????\r\n  1 ?? ? ? ? ? \r\n  2 ?? ? ? ? ? \r\nu 3 ?? ? ? ? ? \r\n  4 ?? ? ? ? ? \r\n  5 ?? ? ? ? ? \n\nOur initial list LLL, then, is formed by listing all pairs (u,v)(u, v)(u,v) with a \'?\' and sorting in the order described above. We get the following list:\n #   u  v  h\r\n 1.  2  1  0\r\n 2.  2  3  1\r\n 3.  3  1  0\r\n 4.  3  2  1\r\n 5.  3  4  2\r\n 6.  3  5  2\r\n 7.  4  1  0\r\n 8.  4  2  1\r\n 9.  4  3  1\r\n10.  4  5  2\r\n11.  5  1  0\r\n12.  5  2  1\r\n13.  5  3  1\r\n14.  5  4  2\n\nFor i=1,2,3i = 1, 2, 3i=1,2,3, we need to decrypt eie_iei\xe2\x80\x8b to get cic_ici\xe2\x80\x8b, then find the corresponding reparenting (ui,vi)(u_i,v_i)(ui\xe2\x80\x8b,vi\xe2\x80\x8b) in the current list LLL, remove it from LLL and use it to update our decryption key ddd. The initial value of ddd is 000. The first encrypted choice is e1=5e_1 = 5e1\xe2\x80\x8b=5; we decrypt it to get c1=d\xe2\x8a\x95e1=0\xe2\x8a\x955=5c_1 = d \\oplus e_1 = 0 \\oplus 5 = 5c1\xe2\x80\x8b=d\xe2\x8a\x95e1\xe2\x80\x8b=0\xe2\x8a\x955=5, so the reparenting corresponding to the first choice is the 555-th entry in the current list LLL, which is (u1,v1)=(3,4)(u_1, v_1) = (3, 4)(u1\xe2\x80\x8b,v1\xe2\x80\x8b)=(3,4). We update ddd to (0+21\xe2\x8b\x85u1+31\xe2\x8b\x85v1)\xe2\x80\x89%\xe2\x80\x89(109+7)=18(0 + 2^1 \\cdot u_1 + 3^1 \\cdot v_1) \\,\\%\\, (10^9+7) = 18(0+21\xe2\x8b\x85u1\xe2\x80\x8b+31\xe2\x8b\x85v1\xe2\x80\x8b)%(109+7)=18 and remove the 555-th element from LLL, which becomes\n #   u  v  h\r\n 1.  2  1  0\r\n 2.  2  3  1\r\n 3.  3  1  0\r\n 4.  3  2  1\r\n 5.  3  5  2\r\n 6.  4  1  0\r\n 7.  4  2  1\r\n 8.  4  3  1\r\n 9.  4  5  2\r\n10.  5  1  0\r\n11.  5  2  1\r\n12.  5  3  1\r\n13.  5  4  2\n\nOn to the second choice! e2=23e_2 = 23e2\xe2\x80\x8b=23, so c2=18\xe2\x8a\x9523=5c_2 = 18 \\oplus 23 = 5c2\xe2\x80\x8b=18\xe2\x8a\x9523=5 and the reparenting (u2,v2)(u_2, v_2)(u2\xe2\x80\x8b,v2\xe2\x80\x8b) is (3,5)(3, 5)(3,5). We update ddd again to (18+22\xe2\x8b\x85u2+32\xe2\x8b\x85v2)\xe2\x80\x89%\xe2\x80\x89(109+7)=75(18 + 2^2 \\cdot u_2 + 3^2 \\cdot v_2) \\,\\%\\, (10^9+7) = 75(18+22\xe2\x8b\x85u2\xe2\x80\x8b+32\xe2\x8b\x85v2\xe2\x80\x8b)%(109+7)=75 and remove (3,5)(3, 5)(3,5) from our list LLL, which becomes\n #   u  v  h\r\n 1.  2  1  0\r\n 2.  2  3  1\r\n 3.  3  1  0\r\n 4.  3  2  1\r\n 5.  4  1  0\r\n 6.  4  2  1\r\n 7.  4  3  1\r\n 8.  4  5  2\r\n 9.  5  1  0\r\n10.  5  2  1\r\n11.  5  3  1\r\n12.  5  4  2\n\nOn to the third and final choice!  With e3=72e_3 = 72e3\xe2\x80\x8b=72, we decrypt c3=75\xe2\x8a\x9572=3c_3 = 75 \\oplus 72 = 3c3\xe2\x80\x8b=75\xe2\x8a\x9572=3, so the reparenting (u3,v3)=(3,1)(u_3, v_3) = (3, 1)(u3\xe2\x80\x8b,v3\xe2\x80\x8b)=(3,1). We use this to update ddd for the final time to (75+23\xe2\x8b\x85u3+33\xe2\x8b\x85v3)\xe2\x80\x89%\xe2\x80\x89(109+7)=126(75 + 2^3 \\cdot u_3 + 3^3 \\cdot v_3) \\,\\%\\, (10^9+7) = 126(75+23\xe2\x8b\x85u3\xe2\x80\x8b+33\xe2\x8b\x85v3\xe2\x80\x8b)%(109+7)=126.\nWe have now processed all QQQ choices, and the final decryption key is d=126d=126d=126.\nExample case 2: The tree GGG is\n\nThere are 494949 possible reparentings; again, we only show a representative sample of them and their validity:\n\nThe whole table of validity of reparentings is\n           v\r\n     1 2 3 4 5 6 7 \r\n     ?????????????\r\n  1 ?? ? ? ? ? ? ? \r\n  2 ?? ? ? ? ? ? ? \r\n  3 ?? ? ? ? ? ? ? \r\nu 4 ?? ? ? ? ? ? ? \r\n  5 ?? ? ? ? ? ? ? \r\n  6 ?? ? ? ? ? ? ? \r\n  7 ?? ? ? ? ? ? ? \n\nBy listing the valid ones and sorting them in the described order, we get our initial list LLL:\n #   u  v  h\r\n 1.  2  1  0\r\n 2.  2  5  1\r\n 3.  2  6  1\r\n 4.  2  7  1\r\n 5.  2  3  2\r\n 6.  2  4  2\r\n 7.  3  1  0\r\n 8.  3  2  1\r\n 9.  3  5  1\r\n10.  3  6  1\r\n11.  3  7  1\r\n12.  3  4  2\r\n13.  4  1  0\r\n14.  4  2  1\r\n15.  4  5  1\r\n16.  4  6  1\r\n17.  4  7  1\r\n18.  4  3  2\r\n19.  5  1  0\r\n20.  5  2  1\r\n21.  5  6  1\r\n22.  5  7  1\r\n23.  6  1  0\r\n24.  6  2  1\r\n25.  6  5  1\r\n26.  6  7  1\r\n27.  6  3  2\r\n28.  6  4  2\r\n29.  7  1  0\r\n30.  7  2  1\r\n31.  7  5  1\r\n32.  7  6  1\r\n33.  7  3  2\r\n34.  7  4  2\n\nThe initial value of ddd is 000. The first encrypted value is e1=9e_1 = 9e1\xe2\x80\x8b=9 and we decrypt it to get c1=d\xe2\x8a\x95e1=0\xe2\x8a\x959=9c_1 = d \\oplus e_1 = 0 \\oplus 9 = 9c1\xe2\x80\x8b=d\xe2\x8a\x95e1\xe2\x80\x8b=0\xe2\x8a\x959=9. The reparenting (u1,v1)(u_1, v_1)(u1\xe2\x80\x8b,v1\xe2\x80\x8b) is the 999-th element of LLL, i.e. (u1,v1)=(3,5)(u_1, v_1) = (3, 5)(u1\xe2\x80\x8b,v1\xe2\x80\x8b)=(3,5). We update ddd to (0+21\xe2\x8b\x85u1+31\xe2\x8b\x85v1)\xe2\x80\x89%\xe2\x80\x89(109+7)=21(0 + 2^1 \\cdot u_1 + 3^1 \\cdot v_1) \\,\\%\\, (10^9+7) = 21(0+21\xe2\x8b\x85u1\xe2\x80\x8b+31\xe2\x8b\x85v1\xe2\x80\x8b)%(109+7)=21 and remove (3,5)(3, 5)(3,5) from the list LLL. (To save space, we do not show LLL after each removal.)\nOn to the next encrypted value e2=6e_2 = 6e2\xe2\x80\x8b=6: we decrypt it to get c2=21\xe2\x8a\x956=19c_2 = 21 \\oplus 6 = 19c2\xe2\x80\x8b=21\xe2\x8a\x956=19, so the reparenting (u2,v2)(u_2, v_2)(u2\xe2\x80\x8b,v2\xe2\x80\x8b) is the 191919-th element of LLL now (the 202020-th element in the initial list), i.e. (5,2)(5, 2)(5,2). We update ddd to (21+22\xe2\x8b\x85u2+32\xe2\x8b\x85v2)\xe2\x80\x89%\xe2\x80\x89(109+7)=59(21 + 2^2 \\cdot u_2 + 3^2 \\cdot v_2) \\,\\%\\, (10^9+7) = 59(21+22\xe2\x8b\x85u2\xe2\x80\x8b+32\xe2\x8b\x85v2\xe2\x80\x8b)%(109+7)=59 and remove (5,2)(5, 2)(5,2) from LLL.\nNext, e3=35e_3 = 35e3\xe2\x80\x8b=35, so c3=59\xe2\x8a\x9535=24c_3 = 59 \\oplus 35 = 24c3\xe2\x80\x8b=59\xe2\x8a\x9535=24, (u3,v3)=(6,7)(u_3, v_3) = (6, 7)(u3\xe2\x80\x8b,v3\xe2\x80\x8b)=(6,7), we update ddd to (59+23\xe2\x8b\x85u3+33\xe2\x8b\x85v3)\xe2\x80\x89%\xe2\x80\x89(109+7)=296(59 + 2^3 \\cdot u_3 + 3^3 \\cdot v_3) \\,\\%\\, (10^9+7) = 296(59+23\xe2\x8b\x85u3\xe2\x80\x8b+33\xe2\x8b\x85v3\xe2\x80\x8b)%(109+7)=296 and remove (6,7)(6, 7)(6,7) from LLL.\nNext, e4=313e_4 = 313e4\xe2\x80\x8b=313, so c4=296\xe2\x8a\x95313=17c_4 = 296 \\oplus 313 = 17c4\xe2\x80\x8b=296\xe2\x8a\x95313=17, (u4,v4)=(4,3)(u_4, v_4) = (4, 3)(u4\xe2\x80\x8b,v4\xe2\x80\x8b)=(4,3), we update ddd to (296+24\xe2\x8b\x85u4+34\xe2\x8b\x85v4)\xe2\x80\x89%\xe2\x80\x89(109+7)=603(296 + 2^4 \\cdot u_4 + 3^4 \\cdot v_4) \\,\\%\\, (10^9+7) = 603(296+24\xe2\x8b\x85u4\xe2\x80\x8b+34\xe2\x8b\x85v4\xe2\x80\x8b)%(109+7)=603 and remove (4,3)(4, 3)(4,3) from LLL.\nThe last of Chef\'s encrypted choices is e5=602e_5 = 602e5\xe2\x80\x8b=602, so c5=603\xe2\x8a\x95602=1c_5 = 603 \\oplus 602 = 1c5\xe2\x80\x8b=603\xe2\x8a\x95602=1, (u5,v5)=(2,1)(u_5, v_5) = (2, 1)(u5\xe2\x80\x8b,v5\xe2\x80\x8b)=(2,1). We update ddd to (603+25\xe2\x8b\x85u5+35\xe2\x8b\x85v5)\xe2\x80\x89%\xe2\x80\x89(109+7)=910(603 + 2^5 \\cdot u_5 + 3^5 \\cdot v_5) \\,\\%\\, (10^9+7) = 910(603+25\xe2\x8b\x85u5\xe2\x80\x8b+35\xe2\x8b\x85v5\xe2\x80\x8b)%(109+7)=910.\nWe have now processed all QQQ of Chef\'s choices, and the final decryption key is d=910d = 910d=910.'