b"Problem\nRead problems statements in Mandarin Chinese, Russian, Vietnamese, and Bengali as well.\nThe city of Hunterland can be represented as a grid with NNN rows (numbered 111 through NNN) and MMM columns (numbered 111 through MMM). Let's denote a cell in row rrr and column ccc by (r,c)(r,c)(r,c). Ahmet, the mayor, plans to develop the underground water system of Hunterland.\nThere is a large reservoir of water in the cell (1,1)(1, 1)(1,1). Water from the reservoir must reach the cell (N,M)(N, M)(N,M) through a simple path in a network of underground pipes. From each cell (i,j)(i,j)(i,j), water flows out through a one-directional pipe with a given capacity ai,ja_{i,j}ai,j\xe2\x80\x8b and direction di,jd_{i,j}di,j\xe2\x80\x8b (up, down, left or right), either to a side-adjacent cell or out of the grid. At any moment, a pipe cannot hold more water than its capacity. Each cell, however, can receive water from any number of adjacent cells; in particular, there can be pairs of cells which send water directly to each other through two pipes with opposite directions.\nDue to poor planning of the previous mayor, the N\xe2\x8b\x85MN \\cdot MN\xe2\x8b\x85M pipes do not have optimal capacities or directions. Ahmet employs Faruk the engineer to rectify this network. Faruk does not have much time, so he may only perform up to KKK operations. In each operation, he should:\n\nchoose some outgoing pipe with positive capacity\ndecrease its capacity by 111\nrotate it 90 degrees clockwise, i.e. change its direction in one of the following ways: up to right, right to down, down to left or left to up\n\nFaruk's goal is to maximise the amount of water that can be sent from the cell (1,1)(1,1)(1,1) to the cell (N,M)(N,M)(N,M) per unit of time. Specifically, for each simple path along pipes from the cell (1,1)(1, 1)(1,1) to (N,M)(N, M)(N,M) in the final network, consider the minimum of capacities of pipes in this path; the amount of water that can be sent from (1,1)(1, 1)(1,1) to (N,M)(N, M)(N,M) per unit of time is the maximum of these minimum values, or 000 if there is no valid path. Help Faruk determine this maximum possible amount of water that can be sent from the cell (1,1)(1,1)(1,1) to the cell (N,M)(N,M)(N,M).\nNote that it is not required to minimise the number of clockwise rotations. Also note that the capacity and direction of the pipe from the cell (N,M)(N, M)(N,M) do not affect the answer, but have been given on the input for uniformity.\nInput\n\nThe first line of the input contains a single integer TTT denoting the number of test cases. The description of TTT test cases follows.\nThe first line of each test case contains three space-separated integers NNN, MMM and KKK.\nNNN lines follow. For each valid iii, the iii-th of these lines contains MMM space-separated integers ai,1,ai,2,\xe2\x80\xa6,ai,Ma_{i,1}, a_{i,2}, \\ldots, a_{i,M}ai,1\xe2\x80\x8b,ai,2\xe2\x80\x8b,\xe2\x80\xa6,ai,M\xe2\x80\x8b.\nNNN more lines follow. For each valid iii, the iii-th of these lines contains a single string with length MMM; for each valid jjj, the jjj-th character of this string denotes the direction di,jd_{i,j}di,j\xe2\x80\x8b of the pipe from the cell (i,j)(i,j)(i,j):\n\n'U' denotes an outgoing pipe directed upwards \xe2\x80\x95 to the cell (i\xe2\x88\x921,j)(i-1, j)(i\xe2\x88\x921,j)\n'R' denotes an outgoing pipe directed to the right \xe2\x80\x95 to the cell (i,j+1)(i, j+1)(i,j+1)\n'D' denotes an outgoing pipe directed downwards \xe2\x80\x95 to the cell (i+1,j)(i+1, j)(i+1,j)\n'L' denotes an outgoing pipe directed to the left \xe2\x80\x95 to the cell (i,j\xe2\x88\x921)(i, j-1)(i,j\xe2\x88\x921)\n\n\n\nOutput\nFor each test case, print a single line containing one integer \xe2\x80\x95 the maximum amount of water that can reach the cell (N,M)(N, M)(N,M) per unit of time.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa4160,0001 \\leq T \\leq 160,0001\xe2\x89\xa4T\xe2\x89\xa4160,000\n1\xe2\x89\xa4N,M\xe2\x89\xa44001 \\leq N, M \\leq 4001\xe2\x89\xa4N,M\xe2\x89\xa4400\n2\xe2\x89\xa4N\xe2\x8b\x85M2 \\leq N \\cdot M2\xe2\x89\xa4N\xe2\x8b\x85M\n0\xe2\x89\xa4K\xe2\x89\xa41090 \\leq K \\leq 10^90\xe2\x89\xa4K\xe2\x89\xa4109\n4\xe2\x89\xa4ai,j\xe2\x89\xa41094 \\leq a_{i,j} \\leq 10^94\xe2\x89\xa4ai,j\xe2\x80\x8b\xe2\x89\xa4109 for each valid i,ji,ji,j\ndi,jd_{i,j}di,j\xe2\x80\x8b is 'U', 'R', 'D', or 'L' for each valid i,ji,ji,j\nthe sum of N\xe2\x8b\x85MN \\cdot MN\xe2\x8b\x85M over all test cases does not exceed 160,000160,000160,000\n\nExample Input 1\n1\r\n3 3 1\r\n4 4 4\r\n5 4 4\r\n4 8 4\r\nDRR\r\nDUU\r\nURL\n\nExample Output 1\n3\n\nExplanation\nExample case 1: Water can flow from (1,1)(1,1)(1,1) down to (2,1)(2,1)(2,1), then again down to (3,1)(3,1)(3,1), then right to (3,2)(3,2)(3,2) and again right to (3,3)(3,3)(3,3). Since the initial direction of the pipe from the cell (3,1)(3,1)(3,1) is upwards, we need to change it using one operation; after this operation, it is directed right and its capacity is 333. All other pipes have correct directions. This path gives the maximum possible amount of water, which is 333.\nExample Input 2\n4\r\n1 2 3\r\n5 100\r\nDL\r\n2 1 0\r\n100\r\n5\r\nD\r\nL\r\n1 2 1\r\n10 10\r\nLR\r\n3 3 5\r\n10 20 4\r\n9 8 6\r\n16 15 12\r\nRRD\r\nRDD\r\nLDU\n\nExample Output 2\n2\r\n100\r\n0\r\n8\n\nExample Input 3\n4\r\n3 3 1000000000\r\n4776 15202 12355\r\n14820 996 21033\r\n32699 5719 31549\r\nULL\r\nLLR\r\nRLD\r\n3 3 1000000000\r\n10475 8939 23763\r\n25687 26437 9851\r\n4998 1101 8817\r\nDRU\r\nLRL\r\nRDD\r\n3 3 1000000000\r\n14671 3820 23657\r\n18786 215 9033\r\n21941 21658 11038\r\nUDU\r\nLRU\r\nLRD\r\n3 3 1000000000\r\n15180 16030 2171\r\n32602 28043 31232\r\n8501 4294 29114\r\nUDR\r\nDLL\r\nRDD\n\nExample Output 3\n4775\r\n9848\r\n14669\r\n15179\n"