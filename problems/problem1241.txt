b'Problem\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\n"It does not matter how slowly you go as long as you do not stop." - Confucius\nYou are given an array A1,A2,\xe2\x80\xa6,ANA_1, A_2, \\ldots, A_NA1\xe2\x80\x8b,A2\xe2\x80\x8b,\xe2\x80\xa6,AN\xe2\x80\x8b and an integer KKK. For each subarray S=[Al,Al+1,\xe2\x80\xa6,Ar]S = [A_l, A_{l+1}, \\ldots, A_r]S=[Al\xe2\x80\x8b,Al+1\xe2\x80\x8b,\xe2\x80\xa6,Ar\xe2\x80\x8b] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4N1 \\le l \\le r \\le N1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4N):\n\nLet\'s define an array BBB as SSS concatenated with itself mmm times, where mmm is the smallest integer such that m(r\xe2\x88\x92l+1)\xe2\x89\xa5Km(r-l+1) \\ge Km(r\xe2\x88\x92l+1)\xe2\x89\xa5K.\nNext, let\'s sort BBB and define X=BKX = B_KX=BK\xe2\x80\x8b, i.e. as a KKK-th smallest element of BBB. Note that \xe2\x88\xa3B\xe2\x88\xa3\xe2\x89\xa5K|B| \\ge K\xe2\x88\xa3B\xe2\x88\xa3\xe2\x89\xa5K.\nThen, let\'s define FFF as the number of occurrences of XXX in SSS.\nThe subarray SSS is beautiful if FFF occurs in SSS at least once.\n\nFind the number of beautiful subarrays of AAA. Two subarrays Al,Al+1,\xe2\x80\xa6,ArA_l, A_{l+1}, \\ldots, A_rAl\xe2\x80\x8b,Al+1\xe2\x80\x8b,\xe2\x80\xa6,Ar\xe2\x80\x8b and Ap,Ap+1,\xe2\x80\xa6,AqA_p, A_{p+1}, \\ldots, A_qAp\xe2\x80\x8b,Ap+1\xe2\x80\x8b,\xe2\x80\xa6,Aq\xe2\x80\x8b are different if l\xe2\x89\xa0pl \\neq pl\xee\x80\xa0=p or r\xe2\x89\xa0qr \\neq qr\xee\x80\xa0=q.\nInput\n\nThe first line of the input contains a single integer TTT denoting the number of test cases. The description of TTT test cases follows.\nThe first line of each test case contains two space-separated integers NNN and KKK.\nThe second line contains NNN space-separated integers A1,A2,\xe2\x80\xa6,ANA_1, A_2, \\ldots, A_NA1\xe2\x80\x8b,A2\xe2\x80\x8b,\xe2\x80\xa6,AN\xe2\x80\x8b.\n\nOutput\nFor each test case, print a single line containing one integer - the number of beautiful subarrays.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa451 \\le T \\le 51\xe2\x89\xa4T\xe2\x89\xa45\n1\xe2\x89\xa4N\xe2\x89\xa42,0001 \\le N \\le 2,0001\xe2\x89\xa4N\xe2\x89\xa42,000\n1\xe2\x89\xa4K\xe2\x89\xa41091 \\le K \\le 10^91\xe2\x89\xa4K\xe2\x89\xa4109\n1\xe2\x89\xa4Ai\xe2\x89\xa420001 \\le A_i \\le 20001\xe2\x89\xa4Ai\xe2\x80\x8b\xe2\x89\xa42000 for each valid iii\n\nSubtasks\nSubtask #1 (20 points): 1\xe2\x89\xa4N\xe2\x89\xa42001 \\le N \\le 2001\xe2\x89\xa4N\xe2\x89\xa4200\nSubtask #2 (80 points): original constraints\nSample 1:\nInputOutput1\n3 3\n1 2 33\nExplanation:\nExample case 1: There are six subarrays of AAA: [1][1][1], [2][2][2], [3][3][3], [1,2][1, 2][1,2], [2,3][2, 3][2,3], [1,2,3][1, 2, 3][1,2,3]. The corresponding arrays BBB are [1,1,1][1, 1, 1][1,1,1], [2,2,2][2, 2, 2][2,2,2], [3,3,3][3, 3, 3][3,3,3], [1,2,1,2][1, 2, 1, 2][1,2,1,2], [2,3,2,3][2, 3, 2, 3][2,3,2,3], [1,2,3][1, 2, 3][1,2,3].\nThree of the subarrays are beautiful: [1][1][1], [1,2][1, 2][1,2] and [1,2,3][1, 2, 3][1,2,3]. For these subarrays, XXX is 111, 222 and 333 respectively (for example, for S=[1,2]S = [1, 2]S=[1,2], B=[1,2,1,2]B = [1, 2, 1, 2]B=[1,2,1,2] is sorted to [1,1,2,2][1, 1, 2, 2][1,1,2,2] and X=2X = 2X=2 is the 333-rd element). Then, F=1F = 1F=1 for each of these subarrays, and each of these subarrays contains 111.'