b'Problem\n Read problems statements in Mandarin Chinese  and Russian.\nYou are given an 1-based array A and its fixed parameters: R, p1, p2. You need to mantain this array, performing some operations. The operations are as follows:\n\n\n0 S D X Y\nAdd an AGP with the start term of S, the common difference of D, common ratio of R from the X-th to the to Y-th element of A.\nIn other words: add S , (S+D)*R , (S+2D)*R2 ,....., (S+(Y-X)*D)*RY-X respectively to A[X], A[X+1], ..., A[Y].\n\n\n1 X g\nReplace the value of A[X] to (A[X])g modulo p2.\nIn other words: A[x] = (A[X])g modulo p2.\n\n\n2 X Y\nReport the sum of elements in A from the X-th to the Y-th modulo p1.\nIn other words: output  (A[X] + ...... + A[Y]) modulo p1.\n\nInput\nThe first line of input contains an integer T denoting the number of test cases. The description of T test cases follows.\nThe first line of each test case contains 5 single space separated integers: N, Q, R, p1, p2).\nThe next line contains N single space separated integers (each is between 0 and 100000 inclusive).\nThen, there are Q lines denoting the queries in the format, described above.\nOutput\nFor each query of the type 2 output the sum of all elements of A from the X-th to the Y-th modulo p1.\nConstraints\n\n1 \xe2\x89\xa4 Sum of N over all testcases \xe2\x89\xa4 105 \n1 \xe2\x89\xa4 Sum of Q over all testcases \xe2\x89\xa4 105 \n1 \xe2\x89\xa4 N, Q, S, D \xe2\x89\xa4 105\n p1, p2 are primes \n 2 \xe2\x89\xa4 p1, p2 \xe2\x89\xa4 108\n 1 \xe2\x89\xa4 R \xe2\x89\xa4 109\n 1 \xe2\x89\xa4 g \xe2\x89\xa4 103\n\nExample\nInput\n2\n5 3 2 7 11\n0 0 0 0 0\n0 2 3 1 3\n1 2 2\n2 1 5\n5 3 3 11 7\n1 2 3 4 5\n0 2 3 1 3\n1 2 2\n2 1 5\n\nOutput\n0\n1\n\nExplanation\n\nThe first test case\nInitially A = [0,0,0,0,0] \nAfter the first query : A = [2,10,32,0,0]\nAfter the second query : A = [2,1,32,0,0] as (10 * 10) modulo 11 = 1\nSo in the third query :  2 + 1 + 32 + 0 + 0 = 35 , so 35 modulo 7 = 0\n\n\n\nThe second test case\nInitially A = [1,2,3,4,5] \nAfter the first query : A = [3,17,75,4,5]\nAfter the second query : A = [3,2,75,4,5] as (17*17) modulo 7 = 2\nSo in the third query :  3 + 2 + 75 + 4 + 5 = 89 , so 89 modulo 11 = 1\n'