b"Problem\nRead problem statements in Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nYou are given a tree with NNN nodes (numbered 111 through NNN), rooted at node 111. For each valid iii, node iii has a value aia_iai\xe2\x80\x8b written on it.\nAn undirected simple path between any two nodes uuu and vvv is said to be vertical if u=vu=vu=v or uuu is an ancestor of vvv or vvv is an ancestor of uuu. Let's define a vertical partition of the tree as a set of vertical paths such that each node belongs to exactly one of these paths.\nYou are also given a sequence of NNN integers b1,b2,\xe2\x80\xa6,bNb_1, b_2, \\ldots, b_Nb1\xe2\x80\x8b,b2\xe2\x80\x8b,\xe2\x80\xa6,bN\xe2\x80\x8b. A vertical partition is good if, for each of its paths, we can permute the values written on the nodes in this path, and this can be done in such a way that we reach a state where for each valid iii, the value written on node iii is bib_ibi\xe2\x80\x8b.\nThe difficulty of your task is described by a parameter SSS. If S=1S=1S=1, your task is only to determine whether at least one good vertical partition exists. If S=2S=2S=2, you are required to find the number of good vertical partitions modulo 1,000,000,0071,000,000,0071,000,000,007 (109+710^9+7109+7).\nInput\n\nThe first line of the input contains a single integer TTT denoting the number of test cases. The description of TTT test cases follows.\nThe first line of each test case contains two space-separated integers NNN and SSS.\nEach of the next N\xe2\x88\x921N-1N\xe2\x88\x921 lines contains two space-separated integers uuu and vvv denoting that nodes uuu and vvv are connected by an edge.\nThe next line contains NNN space-separated integers a1,a2,\xe2\x80\xa6,aNa_1, a_2, \\ldots, a_Na1\xe2\x80\x8b,a2\xe2\x80\x8b,\xe2\x80\xa6,aN\xe2\x80\x8b.\nThe line after that contains NNN space-separated integers b1,b2,\xe2\x80\xa6,bNb_1, b_2, \\ldots, b_Nb1\xe2\x80\x8b,b2\xe2\x80\x8b,\xe2\x80\xa6,bN\xe2\x80\x8b.\n\nOutput\nFor each test case, print a single line containing one integer:\n\nIf S=1S=1S=1, this integer should be 111 if a good vertical partition exists or 000 if it does not exist.\nIf S=2S=2S=2, this integer should be the number of good vertical partitions modulo 1,000,000,0071,000,000,0071,000,000,007 (109+710^9+7109+7).\n\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa41061 \\le T \\le 10^61\xe2\x89\xa4T\xe2\x89\xa4106\n1\xe2\x89\xa4N\xe2\x89\xa41051 \\leq N \\leq 10^51\xe2\x89\xa4N\xe2\x89\xa4105\nS\xe2\x88\x88{1,2}S \\in \\{1, 2\\}S\xe2\x88\x88{1,2}\n1\xe2\x89\xa4u,v\xe2\x89\xa4N1 \\leq u, v \\leq N1\xe2\x89\xa4u,v\xe2\x89\xa4N\nthe graph described on the input is a tree\n1\xe2\x89\xa4ai,bi\xe2\x89\xa41061 \\leq a_i, b_i \\leq 10^61\xe2\x89\xa4ai\xe2\x80\x8b,bi\xe2\x80\x8b\xe2\x89\xa4106 for each valid iii\nthe sum of NNN over all test cases does not exceed 10610^6106\n\nSubtasks\nSubtask #1 (40 points, time limit 1 seconds): the sum of NNN over all test cases does not exceed 1,0001,0001,000\nSubtask #2 (30 points, time limit 2 seconds): S=1S = 1S=1\nSubtask #3 (30 points, time limit 2 seconds): original constraints\nSample 1:\nInputOutput4\n3 2\n1 2\n2 3\n4 5 6\n4 6 5\n6 2\n1 2\n1 3\n2 4\n3 5\n3 6\n10 20 30 40 50 60\n10 40 50 20 30 60\n6 1\n1 2\n1 3\n2 4\n3 5\n3 6\n10 20 30 40 50 60\n10 40 50 20 30 60\n1 2\n1\n22\n3\n1\n0\nExplanation:\nExample case 1: The good vertical partitions are {[1],[2,3]}\\{[1], [2, 3]\\}{[1],[2,3]} and {[1,2,3]}\\{[1, 2, 3]\\}{[1,2,3]}.\nExample case 2: The good vertical partitions are:\n\n{[1,2,4],[3,5],[6]}\\{[1, 2, 4], [3, 5], [6]\\}{[1,2,4],[3,5],[6]}\n{[1],[2,4],[3,5],[6]}\\{[1], [2, 4], [3, 5], [6]\\}{[1],[2,4],[3,5],[6]}\n{[1,3,5],[2,4],[6]}\\{[1, 3, 5], [2, 4], [6]\\}{[1,3,5],[2,4],[6]}\n\nExample case 3: The same as example case 2, but with S=1S=1S=1.\nExample case 4: There is no good vertical partition."