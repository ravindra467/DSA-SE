b'Problem\nRead problem statements in Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nChef has been recently studying strings and probabilities and he came up with a problem for you.\nConsider an alphabet with NNN characters (denoted by c1,c2,\xe2\x80\xa6,cNc_1, c_2, \\ldots, c_Nc1\xe2\x80\x8b,c2\xe2\x80\x8b,\xe2\x80\xa6,cN\xe2\x80\x8b). For each valid iii, the character cic_ici\xe2\x80\x8b has a power aia_iai\xe2\x80\x8b; the power of a string that contains only characters from this alphabet is the sum of their powers (if a character occurs multiple times, its power also occurs in the sum multiple times). For example, the power of a string c1c2c3c_1c_2c_3c1\xe2\x80\x8bc2\xe2\x80\x8bc3\xe2\x80\x8b is a1+a2+a3a_1+a_2+a_3a1\xe2\x80\x8b+a2\xe2\x80\x8b+a3\xe2\x80\x8b and the power of a string c1c2c1c_1c_2c_1c1\xe2\x80\x8bc2\xe2\x80\x8bc1\xe2\x80\x8b is 2\xe2\x8b\x85a1+a22 \\cdot a_1 + a_22\xe2\x8b\x85a1\xe2\x80\x8b+a2\xe2\x80\x8b.\nAlso, for each valid iii, you are given two parameters pip_ipi\xe2\x80\x8b and BiB_iBi\xe2\x80\x8b, where pip_ipi\xe2\x80\x8b is a non-negative integer and Bi\xe2\x88\x88{0,1}B_i \\in \\{0,1\\}Bi\xe2\x80\x8b\xe2\x88\x88{0,1}. For an integer KKK, we can construct a random string SSS with length KKK in the following way:\n\nDefine R=\xe2\x88\x91i=1NpiR = \\sum\\limits_{i=1}^N p_iR=i=1\xe2\x88\x91N\xe2\x80\x8bpi\xe2\x80\x8b.\nFirst, each of the KKK characters of SSS is chosen independently. For each valid iii and jjj, the iii-th character of SSS is cjc_jcj\xe2\x80\x8b with probability pj/Rp_j/Rpj\xe2\x80\x8b/R.\nThen, for each valid iii, we compute the number of occurrences of cic_ici\xe2\x80\x8b in SSS and if the parity of this number of occurrences (i.e. its remainder modulo 222) is different from BiB_iBi\xe2\x80\x8b, we discard the string SSS and try to construct a new random string SSS from the beginning.\nOtherwise (if the parities of occurrences of all characters match the sequence BBB), we have constructed the random string SSS.\nAll parameters are chosen in such a way that there is at least one string we can generate without discarding it. In particular, R>0R \\gt 0R>0.\n\nWhat is the expected value of the power of the constructed string SSS? You need to answer QQQ queries. In each query, you are given a different value of KKK and you should find the expected power.\nFor each query, it can be proved that the expected power can be represented as a fraction PQ\\frac{P}{Q}QP\xe2\x80\x8b, where PPP and QQQ are non-negative integers and QQQ is coprime with 998,244,353998,244,353998,244,353. You need to compute P\xe2\x8b\x85Q\xe2\x88\x921P \\cdot Q^{-1}P\xe2\x8b\x85Q\xe2\x88\x921 modulo 998,244,353998,244,353998,244,353, where Q\xe2\x88\x921Q^{-1}Q\xe2\x88\x921 denotes the multiplicative inverse of QQQ modulo 998,244,353998,244,353998,244,353.\nInput\n\nThe first line of the input contains a single integer NNN.\nNNN lines follow. For each valid iii, the iii-th of these lines contains three space-separated integers aia_iai\xe2\x80\x8b, pip_ipi\xe2\x80\x8b and BiB_iBi\xe2\x80\x8b.\nThe next line contains a single integer QQQ.\nQQQ lines follow. Each of these lines contains a single integer KKK describing a query.\n\nOutput\nFor each query, print a single line containing one integer P\xe2\x8b\x85Q\xe2\x88\x921P \\cdot Q^{-1}P\xe2\x8b\x85Q\xe2\x88\x921 modulo 998,244,353998,244,353998,244,353.\nConstraints\n\n1\xe2\x89\xa4N\xe2\x89\xa42,0001 \\leq N \\leq 2,0001\xe2\x89\xa4N\xe2\x89\xa42,000\n1\xe2\x89\xa4ai\xe2\x89\xa44\xe2\x8b\x851081 \\leq a_i \\leq 4 \\cdot 10^81\xe2\x89\xa4ai\xe2\x80\x8b\xe2\x89\xa44\xe2\x8b\x85108 for each valid iii\n0\xe2\x89\xa4pi\xe2\x89\xa42,0000 \\leq p_i \\leq 2,0000\xe2\x89\xa4pi\xe2\x80\x8b\xe2\x89\xa42,000 for each valid iii\n1\xe2\x89\xa4R\xe2\x89\xa42,0001 \\leq R \\leq 2,0001\xe2\x89\xa4R\xe2\x89\xa42,000\nBi\xe2\x88\x88{0,1}B_i \\in \\{0,1\\}Bi\xe2\x80\x8b\xe2\x88\x88{0,1} for each valid iii\n1\xe2\x89\xa4Q\xe2\x89\xa42\xe2\x8b\x851041 \\leq Q \\leq 2 \\cdot 10^41\xe2\x89\xa4Q\xe2\x89\xa42\xe2\x8b\x85104\n1\xe2\x89\xa4K\xe2\x89\xa44\xe2\x8b\x851081 \\leq K \\leq 4 \\cdot 10^81\xe2\x89\xa4K\xe2\x89\xa44\xe2\x8b\x85108\n\nSubtasks\nSubtask #1 (2 points, time limit 1 second): N,K\xe2\x89\xa415N, K \\leq 15N,K\xe2\x89\xa415\nSubtask #2 (8 points, time limit 1.5 seconds):\n\nK\xe2\x89\xa42,000K \\leq 2,000K\xe2\x89\xa42,000\nQ\xe2\x89\xa4104Q \\leq 10^4Q\xe2\x89\xa4104\n\nSubtask #3 (10 points, time limit 1.5 seconds): N,R\xe2\x89\xa4400N, R \\leq 400N,R\xe2\x89\xa4400\nSubtask #4 (80 points, time limit 2.5 seconds): original constraints\nSample 1:\nInputOutput2\n1 1 0\n2 2 1\n2\n1\n32\n855638022\nExplanation:\nIn the first query, we can only generate the one-character string c2c_2c2\xe2\x80\x8b. Therefore, the expected power is 222.\nIn the second query, we can generate the following strings:\n\nc1c1c2c_1c_1c_2c1\xe2\x80\x8bc1\xe2\x80\x8bc2\xe2\x80\x8b with power 444 and probability 2/142/142/14\nc1c2c1c_1c_2c_1c1\xe2\x80\x8bc2\xe2\x80\x8bc1\xe2\x80\x8b with power 444 and probability 2/142/142/14\nc2c1c1c_2c_1c_1c2\xe2\x80\x8bc1\xe2\x80\x8bc1\xe2\x80\x8b with power 444 and probability 2/142/142/14\nc2c2c2c_2c_2c_2c2\xe2\x80\x8bc2\xe2\x80\x8bc2\xe2\x80\x8b with power 666 and probability 8/148/148/14\n\nThe expected power is therefore 2\xe2\x8b\x854+2\xe2\x8b\x854+2\xe2\x8b\x854+8\xe2\x8b\x8562+2+2+8=367=855,638,022\\frac{2 \\cdot 4 + 2 \\cdot 4 + 2 \\cdot 4 + 8 \\cdot 6}{2+2+2+8} = \\frac{36}{7} = 855,638,0222+2+2+82\xe2\x8b\x854+2\xe2\x8b\x854+2\xe2\x8b\x854+8\xe2\x8b\x856\xe2\x80\x8b=736\xe2\x80\x8b=855,638,022.'