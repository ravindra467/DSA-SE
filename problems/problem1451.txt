b"Problem\nIn a market of mangoes, there are NNN sellers numbered from 111 to NNN. The iii-th seller initially charges a price of AiA_iAi\xe2\x80\x8b coins for each of their mangoes. However, the sellers are very competitive, and they will change prices based on other sellers nearby.\nYou have a simple graph (unweighted, undirected graph containing no self-loops or multiple edges) GGG with NNN vertices and MMM edges. There is an edge between two sellers if and only if they are neighbours. When you buy a mango from a seller numbered XXX, the following occurs:\n\nSeller XXX keeps his price the same.\nEvery seller YYY who is a neighbour of XXX increases their price by 111, that is, AY=AY+1A_Y = A_Y + 1AY\xe2\x80\x8b=AY\xe2\x80\x8b+1 for every YYY who is a neighbour of XXX.\nEvery other seller ZZZ who is not a neighbour of XXX decreases their price by 111; that is, AZ=AZ\xe2\x88\x921A_Z = A_Z - 1AZ\xe2\x80\x8b=AZ\xe2\x80\x8b\xe2\x88\x921 for every ZZZ who is not a neighbour of XXX.\n\nPrices can become zero or negative during this process.\nNow you should process QQQ queries of the following three types:\n\n+\\texttt{+}+ uuu vvv \xe2\x80\x94 Add an edge between nodes uuu and vvv in the graph. It's guaranteed there is no edge between uuu and vvv currently.\n-\\texttt{-}- uuu vvv \xe2\x80\x94 Remove an edge between nodes uuu and vvv in the graph. It's guaranteed there is an edge between uuu and vvv currently.\n?\\texttt{?}? \xe2\x80\x94 Find the minimum amount of money you need to pay so that you can buy exactly one mango from every seller. After queries of this type, the prices of all sellers are reset to their initial value.\n\nInput Format\n\nThe first line contains two integers NNN and MMM - the number of sellers and the number of edges in the graph.\nThe second line contains NNN space-separated integers A1,A2,\xe2\x80\xa6,ANA_1, A_2, \\dots, A_NA1\xe2\x80\x8b,A2\xe2\x80\x8b,\xe2\x80\xa6,AN\xe2\x80\x8b denoting the price array AAA.\nThe next MMM lines each contain two integers uuu and vvv (1\xe2\x89\xa4u,v\xe2\x89\xa4N1 \\le u,v \\le N1\xe2\x89\xa4u,v\xe2\x89\xa4N, u\xe2\x89\xa0vu \\ne vu\xee\x80\xa0=v), representing an edge of GGG.\nThe next line contains the integer QQQ \xe2\x80\x94 the number of queries.\nThe next QQQ lines contain the queries. Each query is in the format given in the problem statement.\nThere is at least one query of type ?\\texttt{?}?.\n\nOutput Format\nFor each query of type ?\\texttt{?}?, output one integer \xe2\x80\x94 the minimum amount of money you need to pay so that you can buy exactly one mango from each seller.\nConstraints\n\n\n1\xe2\x89\xa4N,Q\xe2\x89\xa41051 \\leq N, Q \\leq 10^51\xe2\x89\xa4N,Q\xe2\x89\xa4105\n1\xe2\x89\xa4M\xe2\x89\xa4min\xe2\x81\xa1((N2),105)1 \\leq M \\leq \\min(\\binom{N}{2}, 10^5)1\xe2\x89\xa4M\xe2\x89\xa4min((2N\xe2\x80\x8b),105)\n1\xe2\x89\xa4Ai\xe2\x89\xa41091 \\leq A_i \\leq 10^91\xe2\x89\xa4Ai\xe2\x80\x8b\xe2\x89\xa4109\nIt's guaranteed that GGG is a simple graph, that is, it is an unweighted, undirected graph containing no self-loops or multiple edges.\n\n\nSample 1:\nInputOutput4 3\n8 9 6 10\n2 1\n1 3\n3 4\n6\n?\n+ 2 3\n+ 4 2\n- 3 1\n+ 1 4\n?\n33\n37\n\nExplanation:\nIn the sample test, the first query of type ?\\texttt{?}? is pictured below. The iii-th node (from left to right) contains the price of the iii-th seller. If we buy mangoes from the sellers 111, 444, 333, 222, in that order, then we can pay 888, 999, 888, and 888 coins for the mangoes, respectively, paying a total 333333 coins. It can be proven that this is indeed the minimum amount possible.\n\n\nIt can be proven that for the second query of type ?\\texttt{?}?, the minimum amount we can pay is 373737 coins. Note that the prices of the mangoes reset after each query of type ?\\texttt{?}?."